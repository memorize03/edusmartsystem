<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Davomat | O'qituvchi Panel</title>
    <link rel="stylesheet" href="../styles.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="../data.js"></script>
    <script src="../language-selector.js"></script>
    <script src="../update-students-translations.js"></script>
    <script src="../teacher-language.js"></script>
    <style>
        .main-content {
            background-color: #f5f6fa;
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            padding: 20px;
        }
        
        .attendance-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .attendance-title {
            font-size: 24px;
            color: #333;
            margin: 0;
        }
        
        .stats-cards {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background-color: #fff;
            border-radius: 10px;
            padding: 20px;
            flex: 1;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .card-label {
            font-size: 14px;
            color: #666;
            margin-bottom: 10px;
        }
        
        .card-value {
            font-size: 32px;
            font-weight: bold;
        }
        
        .green-value {
            color: #27ae60;
        }
        
        .red-value {
            color: #e74c3c;
        }
        
        .orange-value {
            color: #f39c12;
        }
        
        .blue-value {
            color: #3498db;
        }
        
        .filter-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            background-color: #fff;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        .filter-group {
            display: flex;
            flex-direction: column;
            flex: 1;
        }
        
        .filter-label {
            font-size: 14px;
            color: #666;
            margin-bottom: 8px;
        }
        
        .filter-select {
            padding: 8px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #fff;
        }
        
        .calendar-container {
            background-color: #fff;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        .calendar-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        
        .calendar-title {
            font-size: 20px;
            font-weight: bold;
            color: #333;
        }
        
        .nav-buttons {
            display: flex;
            gap: 10px;
        }
        
        .nav-button {
            background: none;
            border: none;
            font-size: 14px;
            color: #3498db;
            cursor: pointer;
        }
        
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
        }
        
        .day-header {
            text-align: center;
            font-weight: bold;
            padding: 10px;
            color: #666;
        }
        
        .day-cell {
            height: 100px;
            border: 1px solid #eee;
            padding: 10px;
            text-align: center;
            position: relative;
        }
        
        .day-number {
            position: absolute;
            right: 10px;
            top: 10px;
            font-size: 16px;
            color: #333;
        }
        
        /* Language selector styles */
        .language-selector-wrapper {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        .language-selector {
            display: flex;
            align-items: center;
            background: #fff;
            padding: 8px 15px;
            border-radius: 4px;
            border: 1px solid #ddd;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .language-selector label {
            margin-right: 10px;
            color: #333;
            font-size: 14px;
        }
        
        .language-selector select {
            border: 1px solid #ccc;
            padding: 4px 8px;
            border-radius: 4px;
            background-color: #fff;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <div class="logo">
                <h2 data-translate="systemTitle">Maktab Tizimi</h2>
                <p data-translate="teacherTab">O'qituvchi</p>
            </div>
            <nav>
                <ul>
                    <li class="menu-item">
                        <a href="index.html">
                            <i class="material-icons">dashboard</i>
                            <span data-translate="home">Bosh sahifa</span>
                        </a>
                    </li>
                    <li class="menu-item">
                        <a href="index.html">
                            <i class="material-icons">people</i>
                            <span data-translate="students">O'quvchilar</span>
                        </a>
                    </li>
                    <li class="menu-item active">
                        <a href="attendance.html">
                            <i class="material-icons">event_note</i>
                            <span data-translate="attendance">Davomat</span>
                        </a>
                    </li>
                    <li class="menu-item">
                        <a href="grades.html">
                            <i class="material-icons">grade</i>
                            <span data-translate="grades">Baholar</span>
                        </a>
                    </li>
                    <li class="menu-item">
                        <a href="announcements.html">
                            <i class="material-icons">campaign</i>
                            <span data-translate="announcements">E'lonlar</span>
                        </a>
                    </li>
                    <li class="menu-item logout">
                        <a href="../login.html">
                            <i class="material-icons">logout</i>
                            <span data-translate="logout">Chiqish</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>

        <div class="main-content">
            <h1 data-translate="attendance">Davomat</h1>
            
            <!-- Language selector visible at top-right -->
            <div class="language-selector-wrapper">
                <div class="language-selector">
                    <label data-translate="languageLabel">Til:</label>
                    <select id="language-select" onchange="changeLanguage(this.value)">
                        <option value="uz">O'zbekcha</option>
                        <option value="ru">Русский</option>
                        <option value="en">English</option>
                    </select>
                </div>
            </div>
            
            <!-- Stats cards -->
            <div class="stats-cards">
                <div class="stat-card">
                    <div class="card-label" data-translate="presentCount">Qatnashilgan kunlar</div>
                    <div class="card-value green-value">2</div>
                </div>
                <div class="stat-card">
                    <div class="card-label" data-translate="absentCount">Qatnashilmagan kunlar</div>
                    <div class="card-value red-value">0</div>
                </div>
                <div class="stat-card">
                    <div class="card-label" data-translate="lateCount">Kechikishlar</div>
                    <div class="card-value orange-value">0</div>
                </div>
                <div class="stat-card">
                    <div class="card-label" data-translate="attendancePercentage">Qatnashish foizi</div>
                    <div class="card-value blue-value">100%</div>
                </div>
            </div>
            
            <!-- Filter controls -->
            <div class="filter-row">
                <div class="filter-group">
                    <div class="filter-label" data-translate="monthFilter">Oy bo'yicha</div>
                    <select class="filter-select" id="monthSelect">
                        <option data-translate="january">Yanvar</option>
                        <option data-translate="february">Fevral</option>
                        <option data-translate="march" selected>Mart</option>
                        <option data-translate="april">Aprel</option>
                        <option data-translate="may">May</option>
                        <option data-translate="june">Iyun</option>
                        <option data-translate="july">Iyul</option>
                        <option data-translate="august">Avgust</option>
                        <option data-translate="september">Sentabr</option>
                        <option data-translate="october">Oktabr</option>
                        <option data-translate="november">Noyabr</option>
                        <option data-translate="december">Dekabr</option>
                    </select>
                </div>
                <div class="filter-group">
                    <div class="filter-label" data-translate="yearFilter">Yil bo'yicha</div>
                    <select class="filter-select" id="yearSelect">
                        <option>2023</option>
                        <option>2024</option>
                        <option selected>2025</option>
                    </select>
                </div>
                <div class="filter-group">
                    <div class="filter-label" data-translate="statusFilter">Holat bo'yicha</div>
                    <select class="filter-select" id="statusSelect">
                        <option data-translate="allStatus" selected>Barcha holatlar</option>
                        <option data-translate="present">Keldi</option>
                        <option data-translate="absent">Kelmadi</option>
                        <option data-translate="late">Kechikdi</option>
                    </select>
                </div>
            </div>
            
            <!-- Calendar -->
            <div class="calendar-container">
                <div class="calendar-header">
                    <h2 class="calendar-title">Mart 2025</h2>
                    <div class="nav-buttons">
                        <button class="nav-button" data-translate="previous">« Oldingi</button>
                        <button class="nav-button" data-translate="next">Keyingi »</button>
                    </div>
                </div>
                
                <div class="calendar-grid">
                    <!-- Day headers -->
                    <div class="day-header" data-translate="sunday">Dush</div>
                    <div class="day-header" data-translate="monday">Sesh</div>
                    <div class="day-header" data-translate="tuesday">Chor</div>
                    <div class="day-header" data-translate="wednesday">Pay</div>
                    <div class="day-header" data-translate="thursday">Jum</div>
                    <div class="day-header" data-translate="friday">Shan</div>
                    <div class="day-header" data-translate="saturday">Yak</div>
                    
                    <!-- Empty cells for days before month start -->
                    <div class="day-cell"></div>
                    <div class="day-cell"></div>
                    <div class="day-cell"></div>
                    <div class="day-cell"></div>
                    <div class="day-cell"></div>
                    <div class="day-cell"><div class="day-number">1</div></div>
                    <div class="day-cell"><div class="day-number">2</div></div>
                    
                    <!-- Week 2 -->
                    <div class="day-cell"><div class="day-number">3</div></div>
                    <div class="day-cell"><div class="day-number">4</div></div>
                    <div class="day-cell"><div class="day-number">5</div></div>
                    <div class="day-cell"><div class="day-number">6</div></div>
                    <div class="day-cell"><div class="day-number">7</div></div>
                    <div class="day-cell"><div class="day-number">8</div></div>
                    <div class="day-cell"><div class="day-number">9</div></div>
                    
                    <!-- Additional weeks would continue here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Set up the language selection based on stored preference
        document.addEventListener('DOMContentLoaded', function() {
            // Get the current language from localStorage or default to Uzbek
            const currentLang = localStorage.getItem('selectedLanguage') || 'uz';
            
            // Set the language dropdown to the current language
            const languageSelect = document.getElementById('language-select');
            if (languageSelect) {
                languageSelect.value = currentLang;
            }
            
            // Apply translations
            applyTranslations();
            
            // Apply additional attendance-specific translations
            applyAttendanceTranslations();
            
            // Make sure teacherTab is properly translated
            forceTranslateSidebarTeacher();
        });
        
        // Function to change language
        function changeLanguage(lang) {
            // Store the selected language
            localStorage.setItem('selectedLanguage', lang);
            
            // Apply translations
            if (typeof applyTranslations === 'function') {
                applyTranslations();
            }
            
            // Apply attendance-specific translations
            applyAttendanceTranslations();
            
            // Update teacher label
            forceTranslateSidebarTeacher();
            
            // Refresh the page to apply all translations properly
            location.reload();
        }
        
        // Function to apply attendance-specific translations that might be missing from data.js
        function applyAttendanceTranslations() {
            const currentLang = localStorage.getItem('selectedLanguage') || 'uz';
            
            // Define translations for attendance-specific elements
            const attendanceTranslations = {
                uz: {
                    presentCount: "Qatnashilgan kunlar",
                    absentCount: "Qatnashilmagan kunlar",
                    lateCount: "Kechikishlar",
                    attendancePercentage: "Qatnashish foizi",
                    monthFilter: "Oy bo'yicha",
                    yearFilter: "Yil bo'yicha",
                    statusFilter: "Holat bo'yicha",
                    allStatus: "Barcha holatlar",
                    january: "Yanvar",
                    february: "Fevral",
                    march: "Mart",
                    april: "Aprel",
                    may: "May",
                    june: "Iyun",
                    july: "Iyul",
                    august: "Avgust",
                    september: "Sentabr",
                    october: "Oktabr",
                    november: "Noyabr",
                    december: "Dekabr",
                    sunday: "Dush",
                    monday: "Sesh",
                    tuesday: "Chor",
                    wednesday: "Pay",
                    thursday: "Jum",
                    friday: "Shan",
                    saturday: "Yak",
                    previous: "« Oldingi",
                    next: "Keyingi »"
                },
                ru: {
                    presentCount: "Дни присутствия",
                    absentCount: "Дни отсутствия",
                    lateCount: "Опоздания",
                    attendancePercentage: "Процент посещаемости",
                    monthFilter: "По месяцу",
                    yearFilter: "По году",
                    statusFilter: "По статусу",
                    allStatus: "Все статусы",
                    january: "Январь",
                    february: "Февраль",
                    march: "Март",
                    april: "Апрель",
                    may: "Май",
                    june: "Июнь",
                    july: "Июль",
                    august: "Август",
                    september: "Сентябрь",
                    october: "Октябрь",
                    november: "Ноябрь",
                    december: "Декабрь",
                    sunday: "Пн",
                    monday: "Вт",
                    tuesday: "Ср",
                    wednesday: "Чт",
                    thursday: "Пт",
                    friday: "Сб",
                    saturday: "Вс",
                    previous: "« Предыдущий",
                    next: "Следующий »"
                },
                en: {
                    presentCount: "Present Days",
                    absentCount: "Absent Days",
                    lateCount: "Late Arrivals",
                    attendancePercentage: "Attendance Percentage",
                    monthFilter: "By Month",
                    yearFilter: "By Year",
                    statusFilter: "By Status",
                    allStatus: "All Statuses",
                    january: "January",
                    february: "February",
                    march: "March",
                    april: "April",
                    may: "May",
                    june: "June",
                    july: "July",
                    august: "August",
                    september: "September",
                    october: "October",
                    november: "November",
                    december: "December",
                    sunday: "Sun",
                    monday: "Mon",
                    tuesday: "Tue",
                    wednesday: "Wed",
                    thursday: "Thu",
                    friday: "Fri",
                    saturday: "Sat",
                    previous: "« Previous",
                    next: "Next »"
                }
            };
            
            // Apply translations to elements with data-translate attribute
            document.querySelectorAll('[data-translate]').forEach(element => {
                const key = element.getAttribute('data-translate');
                
                // Only apply if we have a translation for this key
                if (attendanceTranslations[currentLang] && attendanceTranslations[currentLang][key]) {
                    element.textContent = attendanceTranslations[currentLang][key];
                }
            });
            
            // Also update the calendar title with the current month and year
            const calendarTitle = document.querySelector('.calendar-title');
            if (calendarTitle) {
                const month = document.getElementById('monthSelect').options[document.getElementById('monthSelect').selectedIndex].text;
                const year = document.getElementById('yearSelect').value;
                calendarTitle.textContent = `${month} ${year}`;
            }
            
            // Update placeholders based on language
            document.querySelectorAll('[data-translate-placeholder]').forEach(element => {
                const key = element.getAttribute('data-translate-placeholder');
                if (attendanceTranslations[currentLang] && attendanceTranslations[currentLang][key]) {
                    element.placeholder = attendanceTranslations[currentLang][key];
                }
            });
        }
        
        // Function to forcibly translate the sidebar teacher element
        function forceTranslateSidebarTeacher() {
            const sidebarTeacherElement = document.querySelector('.logo p[data-translate="teacherTab"]');
            if (!sidebarTeacherElement) return;
            
            // Get current language
            const currentLang = localStorage.getItem('selectedLanguage') || 'uz';
            
            // Direct hard-coded translations as a reliable fallback
            const translations = {
                uz: 'O\'qituvchi',
                ru: 'Учитель',
                en: 'Teacher'
            };
            
            // Use hard-coded translations for reliability
            const translation = translations[currentLang];
            
            // Only update if different from current text
            if (sidebarTeacherElement.textContent !== translation) {
                console.log('Forcing sidebar teacher to: ' + translation);
                sidebarTeacherElement.textContent = translation;
            }
        }
    </script>
    <script src="../force-update-translations.js"></script>
</body>
</html> 